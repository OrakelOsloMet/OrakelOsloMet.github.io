(this.webpackJsonpreact_app=this.webpackJsonpreact_app||[]).push([[0],{21:function(e,t,n){e.exports={brandText:"navbar_brandText__3XSWe",brandImage:"navbar_brandImage__edego",defaultLinkText:"navbar_defaultLinkText__2jzNV",authenticatedBrandText:"navbar_authenticatedBrandText__3oLFp",authenticatedLinkText:"navbar_authenticatedLinkText__g8guY",invisibleOnMobile:"navbar_invisibleOnMobile__30ez-"}},54:function(e,t,n){e.exports={queueForm:"queueForm_queueForm__Wf_6o"}},57:function(e,t,n){e.exports=n(94)},88:function(e,t,n){e.exports=n.p+"static/media/oslometsvart.3b9b0cc3.png"},89:function(e,t,n){e.exports=n.p+"static/media/oslomethvit.2c306d99.png"},90:function(e,t,n){e.exports=n.p+"static/media/hellothere.be0ec76a.mp3"},92:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),u=n(16),i=n.n(u);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o,c,l=n(34),s=n(8),E=n(15),d=n(49);!function(e){e.AUTH_START="AUTH_START",e.AUTH_SUCCESS="AUTH_SUCCESS",e.AUTH_FAIL="AUTH_FAIL",e.AUTH_LOGOUT="AUTH_LOGOUT",e.CLEAR_ERROR="CLEAR_ERROR"}(o||(o={})),function(e){e.FETCH_QUEUE_START="FETCH_QUEUE_START",e.FETCH_QUEUE_SUCCESS="FETCH_QUEUE_SUCCESS",e.FETCH_QUEUE_FAIL="FETCH_QUEUE_FAIL",e.ADD_TO_QUEUE_START="ADD_TO_QUEUE_START",e.ADD_TO_QUEUE_SUCCESS="ADD_TO_QUEUE_SUCCESS",e.ADD_TO_QUEUE_FAIL="ADD_TO_QUEUE_FAIL",e.DELETE_FROM_QUEUE_START="DELETE_FROM_QUEUE_START",e.DELETE_FROM_QUEUE_SUCCESS="DELETE_FROM_QUEUE_SUCCESS",e.DELETE_FROM_QUEUE_FAIL="DELETE_FROM_QUEUE_FAIL",e.DONE_IN_QUEUE_START="DONE_IN_QUEUE_START",e.DONE_IN_QUEUE_SUCCESS="DONE_IN_QUEUE_SUCCESS",e.DONE_IN_QUEUE_FAIL="DONE_IN_QUEUE_FAIL",e.FETCH_SUBJECTS_START="FETCH_SUBJECTS_START",e.FETCH_SUBJECTS_SUCCESS="FETCH_SUBJECTS_SUCCESS",e.FETCH_SUBJECTS_FAIL="FETCH_SUBJECTS_FAIL"}(c||(c={}));var f,m=n(9),_=n(23),p=function(e,t){return Object(_.a)(Object(_.a)({},e),t)},g={user:null,error:null,loading:!1},T=function(e,t){return p(e,{error:null,loading:!0})},S=function(e,t){return p(e,{user:t.user,error:null,loading:!1})},U=function(e,t){return p(e,{error:t.error,loading:!1})},b=function(e,t){return p(e,{user:null})},C=function(e,t){return p(e,{error:null})},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.AUTH_START:return T(e);case o.AUTH_SUCCESS:return S(e,t);case o.AUTH_FAIL:return U(e,t);case o.AUTH_LOGOUT:return b(e);case o.CLEAR_ERROR:return C(e);default:return e}},O={queueData:[],subjectData:[],error:null,loading:!1},h=function(e,t){return p(e,{error:null,loading:!0})},A=function(e,t){return p(e,{error:t.error,loading:!1})},k=function(e,t){return p(e,{queueData:t.queueData,error:null,loading:!1})},y=function(e,t){return p(e,{error:null,loading:!1})},D=function(e,t){return p(e,{subjectData:t.subjectData,error:null,loading:!1})},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.FETCH_QUEUE_START:case c.ADD_TO_QUEUE_START:case c.DELETE_FROM_QUEUE_START:case c.DONE_IN_QUEUE_START:case c.FETCH_SUBJECTS_START:return h(e);case c.FETCH_QUEUE_FAIL:case c.ADD_TO_QUEUE_FAIL:case c.DELETE_FROM_QUEUE_FAIL:case c.DONE_IN_QUEUE_FAIL:case c.FETCH_SUBJECTS_FAIL:return A(e,t);case c.FETCH_QUEUE_SUCCESS:return k(e,t);case c.ADD_TO_QUEUE_SUCCESS:case c.DELETE_FROM_QUEUE_SUCCESS:case c.DONE_IN_QUEUE_SUCCESS:return y(e);case c.FETCH_SUBJECTS_SUCCESS:return D(e,t);default:return e}},F=Object(s.c)({auth:v,queue:L}),j=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,N=n(3),R=n(50),I=n.n(R),Q="https://orakelqueueservice.herokuapp.com/api/",H=Q+"resources/userguide";!function(e){e.SELECT="select",e.INPUT="input"}(f||(f={}));var x=I.a.create({baseURL:Q}),q=function(e){return{type:o.AUTH_SUCCESS,user:e}},w=function(){return localStorage.removeItem("user"),{type:o.AUTH_LOGOUT}},B=function(){return function(e){var t=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null;t&&t.token?x.post("auth/isTokenValid",t.token).then((function(n){!0===n.data?e(q(t)):e(w())})):e(w())}},M=function(e,t){return function(n){return n({type:o.AUTH_START}),x.post("auth/signin",{username:e,password:t}).then((function(e){if(e.data.token)return localStorage.setItem("user",JSON.stringify(e.data)),n(q(e.data)),!0})).catch((function(e){return n(function(e){return{type:o.AUTH_FAIL,error:e}}(e.response.data.message)),!1}))}},J=function(){return{type:o.CLEAR_ERROR}},V=function(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?{Authorization:"Bearer "+e.token}:{}},P=function(){return function(e){e({type:c.FETCH_QUEUE_START}),x.get("queue/").then((function(t){var n;e((n=t.data,{type:c.FETCH_QUEUE_SUCCESS,queueData:n}))})).catch((function(t){e(function(e){return{type:c.FETCH_QUEUE_FAIL,error:e}}(t.response))}))}},G=function(e){return function(t){t({type:c.ADD_TO_QUEUE_START}),x.post("queue/",e).then((function(){t({type:c.ADD_TO_QUEUE_SUCCESS}),t(P())})).catch((function(e){t(function(e){return{type:c.ADD_TO_QUEUE_FAIL,error:e}}(e.response.data))}))}},z=function(e){return function(t){t({type:c.DELETE_FROM_QUEUE_START}),x.delete("queue/"+e,{headers:V()}).then((function(){t({type:c.DELETE_FROM_QUEUE_SUCCESS}),t(P())})).catch((function(e){t(function(e){return{type:c.DELETE_FROM_QUEUE_FAIL,error:e}}(e.response))}))}},W=function(e){return function(t){t({type:c.DONE_IN_QUEUE_START}),x.post("queue/confirmdone/"+e,null,{headers:V()}).then((function(){t({type:c.DONE_IN_QUEUE_SUCCESS}),t(P())})).catch((function(e){t(function(e){return{type:c.DONE_IN_QUEUE_FAIL,error:e}}(e.response))}))}},X=function(){return function(e){e({type:c.FETCH_SUBJECTS_START}),x.get("subjects/current/").then((function(t){var n;e((n=t.data,{type:c.FETCH_SUBJECTS_SUCCESS,subjectData:n}))})).catch((function(t){e(function(e){return{type:c.FETCH_SUBJECTS_FAIL,error:e}}(t.response))}))}},Y=n(98),K=n(24),$=n(21),Z=n.n($),ee=n(28),te=n.n(ee),ne=n(29),re=n.n(ne),ae=function(e){var t=e.title,n=e.contentText,r=e.url,a=e.hyperlinkText,u=re()(te.a),i=document.createElement("div");return r&&a&&(i.innerHTML='<strong><a href="'.concat(r,'" target="_blank">').concat(a,"</a></strong>")),u.fire({title:t,html:n,footer:r&&a?i:null,icon:"info",confirmButtonText:"Lukk"})},ue=n(5),ie=n.n(ue),oe=n(14),ce=function(e){var t=e.onLoginSubmit,n=e.clearLoginError,r=re()(te.a);return r.fire({title:"Orakel Innlogging",html:'<input type="text" id="login" class="swal2-input" placeholder="Brukernavn">\n                        <input type="password" id="password" class="swal2-input" placeholder="Passord">',confirmButtonText:"Logg Inn",showLoaderOnConfirm:!0,showCancelButton:!0,cancelButtonColor:"#d33",cancelButtonText:"Avbryt",allowOutsideClick:function(){return!r.isLoading()},preConfirm:function(){var e=Object(oe.a)(ie.a.mark((function e(){var n,a,u,i;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.getPopup().querySelector("#login"),a=r.getPopup().querySelector("#password"),u=n.value.trim(),i=a.value.trim(),u&&i){e.next=7;break}return r.showValidationMessage("Oppgi brukernavn og passord!"),e.abrupt("return",!1);case 7:return e.next=9,t(u,i);case 9:if(e.sent){e.next=13;break}return r.showValidationMessage("Ugyldig brukernavn eller passord!"),e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}).then((function(e){e.isDismissed&&n()}))},le=function(e){var t=e.isAuthenticated?Z.a.authenticatedLinkText:Z.a.defaultLinkText,r=e.isAuthenticated?{expand:"lg",bg:"warning"}:{variant:"dark",expand:"lg",bg:"primary"},u=a.a.createElement(K.a.Link,{className:t,onClick:e.isAuthenticated?e.logoutHandler:function(){ce({onLoginSubmit:e.onLoginSubmit,clearLoginError:e.clearLoginError})}},e.isAuthenticated?"Logg Ut":"Admin");return a.a.createElement(Y.a,r,a.a.createElement(Y.a.Brand,{className:Z.a.invisibleOnMobile},a.a.createElement("img",{className:Z.a.brandImage,alt:"OsloMet Logo",src:n(e.isAuthenticated?88:89)})),a.a.createElement(Y.a.Brand,{className:e.isAuthenticated?Z.a.authenticatedBrandText:Z.a.brandText},"Orakel"),a.a.createElement(Y.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),a.a.createElement(Y.a.Collapse,{id:"responsive-navbar-nav"},a.a.createElement(K.a,null,a.a.createElement(K.a.Link,{className:t,onClick:function(){return ae({title:"Discord",contentText:"For digital veiledning benytter vi oss av Discord, og har v\xe5r egen server til dette. Inne p\xe5 serveren setter vi pris p\xe5 om du leser informasjonen i tekstkanalen kalt informasjon, og vi anbefaler alle \xe5 laste ned klienten deres i stedet for \xe5 bruke tjenesten gjennom nettleseren.",url:"https://discord.gg/jgzqYpX",hyperlinkText:"Orakel Discord"})}},"Discord"),a.a.createElement(K.a.Link,{className:t,onClick:function(){return ae({title:"Feilrapportering",contentText:"Orakels k\xf8system er et fritidsprosjekt som er bygget og vedlikeholdt av en person. Det er derfor en viss fare for bugs og feil. Disse kan rapporteres ved \xe5 legge inn en issue p\xe5 GitHub-repoet, eller ved \xe5 ta kontakt med Fredrik Pedersen. Vi setter ogs\xe5 pris p\xe5 \xf8nsker om tilleggsfunksjonalitet :)",url:"https://github.com/OrakelOsloMet/Orakel_Queue_Client/issues",hyperlinkText:"GitHub Repo"})}},"Feilrapportering"),a.a.createElement(K.a.Link,{className:t,onClick:function(){return ae({title:"Om Orakels K\xf8system",contentText:"Coming Soon!",url:H,hyperlinkText:"Brukerveiledning"})}},"Om"),u)))},se=Object(E.b)((function(e){var t;return{isAuthenticated:void 0!==(null===(t=e.auth.user)||void 0===t?void 0:t.token)}}),(function(e){return Object(s.b)({onLoginSubmit:M,clearLoginError:J,logoutHandler:w},e)}))(le),Ee=function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement(se,null),a.a.createElement("main",{className:"mb-5"},e.children))},de=n(97),fe=function(e){var t=[];return e.defaultColumns.forEach((function(e){t.push(a.a.createElement("th",{key:"".concat(e," Header"),scope:"col"},e))})),e.isAuthenticated&&e.loggedInColumns.forEach((function(e){t.push(a.a.createElement("th",{key:"".concat(e," Header"),scope:"col"},e))})),a.a.createElement("thead",{key:"tableHead",className:"thead-dark"},a.a.createElement("tr",null,t))},me=function(e){return a.a.createElement("button",{type:"submit",disabled:e.disabled,className:"btn btn-primary ".concat(e.className),onClick:e.onClick},e.children)},_e=function(e){return a.a.createElement("button",{disabled:e.disabled,className:"btn btn-success ".concat(e.className),onClick:e.onClick},e.children)},pe=function(e){return a.a.createElement("button",{disabled:e.disabled,className:"btn btn-danger ".concat(e.className),onClick:e.onClick},e.children)},ge=function(e){for(var t=e.queueData,n=e.confirmDoneEntity,r=e.deleteQueueEntity,u=e.isAuthenticated,i=e.userRoles,o=e.defaultColumns,c=e.loggedInColumns,l=[],s=function(e){var o="row"+e,c=[];c.push(a.a.createElement("td",{key:"entry"+e,id:"entry"+e},"# ",e+1)),c.push(a.a.createElement("td",{key:"name"+e,id:"name"+e},t[e].name)),c.push(a.a.createElement("td",{key:"subject"+e,id:"subject"+e},t[e].subject)),c.push(a.a.createElement("td",{key:"discord"+e,id:"discord"+e},t[e].digitalConsultation?"Discord":"Datatorget")),u&&i.includes("ROLE_ADMIN")&&c.push(a.a.createElement("td",{key:"actions"+e,id:"action"+e},a.a.createElement(a.a.Fragment,null,a.a.createElement(_e,{onClick:function(){return n(t[e].id)}},"Ferdig"),a.a.createElement(pe,{className:"ml-2",onClick:function(){return r(t[e].id)}},"Slett")))),l.push(a.a.createElement("tr",{key:e,id:o},c))},E=0;E<t.length;E++)s(E);var d=a.a.createElement(fe,{defaultColumns:o,loggedInColumns:c,isAuthenticated:u}),f=a.a.createElement("tbody",null,l);return a.a.createElement(de.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"mb-4"},d,f)},Te=function(){return a.a.createElement("div",{className:"spinner-border text-primary"})},Se=function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e})),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){"undefined"!==typeof(null===n||void 0===n?void 0:n.current)&&(null===n||void 0===n||n.current())}),t);return function(){return clearInterval(e)}}}),[t])},Ue=function(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e})),t.current},be=n(53),Ce=n(90),ve=function(e){var t=Object(be.a)(Ce),n=Object(m.a)(t,1)[0],u=Ue(e.queueData);Object(r.useEffect)((function(){e.pollingFunction()}),[]),Se((function(){e.pollingFunction()}),5e3),Object(r.useEffect)((function(){u&&e.queueData.length>=u.length&&(function(e,t){if(e.length!==t.length)return!1;for(var n=!0,r=0;r<e.length;r++)if(JSON.stringify(e[r])!==JSON.stringify(t[r])){n=!1;break}return n}(e.queueData,u)||n())}),[e.queueData]);var i=void 0===e.queueData?a.a.createElement(Te,null):a.a.createElement(ge,{defaultColumns:["Plassering","Navn","Emne","Arena"],loggedInColumns:["Handlinger"],queueData:e.queueData,isAuthenticated:e.isAuthenticated,userRoles:e.userRoles,confirmDoneEntity:e.confirmDoneEntity,deleteQueueEntity:e.deleteQueueEntity});return a.a.createElement(a.a.Fragment,null,i)},Oe=Object(E.b)((function(e){var t;return{isAuthenticated:null!=(null===(t=e.auth.user)||void 0===t?void 0:t.token),userRoles:e.auth.user?e.auth.user.roles:[],queueData:e.queue.queueData,loading:e.queue.loading,error:e.queue.error}}),(function(e){return Object(s.b)({deleteQueueEntity:z,confirmDoneEntity:W,pollingFunction:P},e)}))(ve),he=n(55),Ae=n(54),ke=n.n(Ae),ye=Object(r.forwardRef)((function(e,t){var n,r,u=e.formElement,i=e.error,o="form-control ml-2 mr-2 mt-2 ";switch(u.inputType){case f.INPUT:r=u,i&&(o+="is-invalid"),n=a.a.createElement("input",Object.assign({name:r.name,ref:t,className:o},r.inputConfig));break;case f.SELECT:r=u,n=a.a.createElement("select",{name:u.name,ref:t,className:o},r.inputConfig.options.map((function(e){return a.a.createElement("option",{key:String(e.value),value:String(e.value)},e.displayValue)})));break;default:n=a.a.createElement("input",{className:"form-control"})}return a.a.createElement(a.a.Fragment,null,n)})),De=function(e){var t=Object(he.a)(),n=t.register,u=t.handleSubmit,i=t.reset,o=t.errors,c=t.formState.isSubmitSuccessful,l=Object(r.useState)({name:"firstname",inputType:f.INPUT,inputConfig:{type:"text",placeholder:"Fornavn"},validation:{minLength:3,errorMessage:"Vennligst oppgi et fornavn p\xe5 minst 3 bokstaver"}}),s=Object(m.a)(l,2),E=s[0],d=(s[1],Object(r.useState)({name:"subject",inputType:f.SELECT,inputConfig:{options:[]}})),p=Object(m.a)(d,2),g=p[0],T=p[1],S=Object(r.useState)({name:"year",inputType:f.SELECT,inputConfig:{options:[{value:1,displayValue:"1. \xe5r"},{value:2,displayValue:"2. \xe5r"},{value:3,displayValue:"3. \xe5r"}]}}),U=Object(m.a)(S,2),b=U[0],C=(U[1],Object(r.useState)({name:"digitalConsultation",inputType:f.SELECT,inputConfig:{options:[{value:!1,displayValue:"Fysisk Veiledning (Datatorget)"},{value:!0,displayValue:"Digital Veiledning (Discord)"}]}})),v=Object(m.a)(C,2),O=v[0];v[1];Object(r.useEffect)((function(){e.subjects.length>0&&h()}),[e.subjects]),Object(r.useEffect)((function(){c&&i()}),[c,i]);var h=function(){var t,n=Object(_.a)({},g);n.inputConfig.options=[],null===(t=e.subjects)||void 0===t||t.forEach((function(e){n.inputConfig.options.push({value:e.name,displayValue:e.name})})),T(n)},A={nameInput:E,subjectSelect:g,yearSelect:b,digitalConsultationSelect:O},k=a.a.createElement("form",{onSubmit:u((function(t){var n=function(e){for(var t=Object(_.a)({},e),n=0,r=Object.entries(t);n<r.length;n++){var a=Object(m.a)(r[n],2),u=a[0],i=a[1];"string"==typeof i&&("true"!==i&&"false"!==i||(t[u]="true"==i),isNaN(Number(i))||(t[u]=parseFloat(i)))}return t}(t),r={id:0,name:n.firstname,subject:n.subject,digitalConsultation:n.digitalConsultation,studyYear:n.year,confirmedDone:!1,timeConfirmedDone:null};e.addQueueEntity(r)})),className:"form-inline mt-5 mb-5 "+ke.a.queueForm},Object.values(A).map((function(e){var t=n;if(e.inputType===f.INPUT){var r=e;t=n({required:r.validation.errorMessage,minLength:{value:r.validation.minLength,message:r.validation.errorMessage}})}return a.a.createElement(ye,{key:e.name,formElement:e,ref:t,error:o.firstname})})),a.a.createElement(me,{className:"ml-2 mr-2 mt-2"},"Registrer"));return a.a.createElement(a.a.Fragment,null,k)},Le=Object(E.b)((function(e){return{subjects:e.queue.subjectData,loading:e.queue.loading,error:e.queue.error}}),(function(e){return Object(s.b)({addQueueEntity:G},e)}))(De),Fe=Object(N.g)(Object(E.b)(null,(function(e){return Object(s.b)({autoLogin:B,getSubjectData:X},e)}))((function(e){var t=e.autoLogin,n=e.getSubjectData;Object(r.useEffect)((function(){t(),n()}),[]);var u=a.a.createElement(N.d,null,a.a.createElement(N.b,{path:"/Orakel_Queue_Client/",exact:!0,render:function(){return a.a.createElement("div",null,a.a.createElement(Le,null),a.a.createElement(Oe,null))}}),a.a.createElement(N.a,{to:"/Orakel_Queue_Client/"}));return a.a.createElement("div",{style:{textAlign:"center"}},a.a.createElement(Ee,null,u))}))),je=(n(92),n(93),Object(s.e)(F,j(Object(s.a)(d.a)))),Ne=a.a.createElement(E.a,{store:je},a.a.createElement(l.a,null,a.a.createElement(Fe,null)));i.a.render(Ne,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[57,1,2]]]);
//# sourceMappingURL=main.0d69c739.chunk.js.map